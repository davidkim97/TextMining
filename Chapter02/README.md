# Chapter 02. 텍스트 전처리

#### 2.1 텍스트 전처리의 개념

- 왜 전처리가 필요한가?
    - 텍스트는 프로그래밍 언어 안에서 문자열로 표현됨.  
    
    - 일반적으로 하나의 문장을 이해할 때는 사용된 단어들의 순차수열로 이해한다.  
    즉, 각각의 단어를 이해하고 단어들의 순서에 따라 의미를 이해한다.  
    따라서 컴퓨터에게 어떤 문장을 이해시키고 싶다면 하나의 문자열로 이루어진 문장 혹은 문서를 단어 단위로 나눈 후에 단어들의 리스트 형태로 변환해야 한다.

    - 텍스트를 전처리해두면 문서분류와 가은 작업을 용이하게 할 수 있다.

- 전처리의 단계
    - 텍스트 전처리(Text Preprocessing) : 주어진 텍스트에서 노이즈와 같이 불필요한 부분을 제거.  
    문장을 표준단어들로 분리, 각 단어의 품사를 파악하는 것.

    ```
    1) 정제(cleaning): 분석에 불필요한 노이즈 제어(noise removal)하는 작업을 말한다.
                       보통 노이즈의 제거는 토큰화 이전에 이루어지나, 토큰화 이후에도 필요한 경우 계속 이루어짐.
                       ex) 분석에 불필요한 단어들을 제거하는데 이를 불용어 제거(stopword removal)라고 한다.

    2) 토큰화(Tokenization): 주어진 텍스트를 원하는 단위(token)로 나누는 작업을 말함.
                            원하는 단어가 문장인 경우 문장 토큰화(sentence tokenization)라고 하고 
                            단어 토큰화(word tokenization)이라고 한다.
    
    3) 정규화 : 같은 의미를 가진 동일한 단어임에도 불구하고 다른 형태로 쓰여진 단어들을 통일시켜서 표준단어로 만드는 작업.
                정규화는 방법에 따라 어간 추출과 표제어 추출(lemmatization)로 나뉜다.

    4) 품사태깅 : 품사는 단어를 문법적인 기능에 따라 분류한 것을 말하며, 명사, 대명사, 동사, 형용사 등이 있다.
                 품사 태깅은 토큰화한 단어에 대해 품사를 파악해 부착하는 것을 의미.
                 같은 단어도 문맥에 따라 의미와 품사가 바뀔 수 있으므로 정확한 품사를 알려면 문맥을 파악해야 함.
    ```

---
#### 2.2 토큰화
- NLTK를 이용해 자연어 처리 및 분석을 진행.

- 문장 토큰화
    - 주어진 텍스트를 원하는 단위(token)로 나누는 작업 진행

    - 문장 토큰화는 여러 문장으로 이루어진 텍스트를 각 문장으로 나누는 것으로 nltk의 sent_tokenize 사용

    - 내부적으로 sent_tokenize는 영어 학습 데이터에 대해 사전학습된 모델을 사용해 토큰화함.

    - 다른 언어에 대해 문장 토큰화를 하려면 사전학습된 모델을 지정해 불러올 수 있다.

- 단어 토큰화
    - 일반적으로 토큰화라고 하면 단어 토큰화(word tokenize)를 의미.

    - NLTK에서 word_tokenize로 가능함.

    - 한국어 텍스트를 정확하게 토큰화하려면 영어와는 다른 방법이 필요.  
    공백과 같이 단어를 구분해 주는 것들을 단어 경계(word boundary)라고 한다.

    - 공백만으로 토큰화가 잘 되지 않는다면 단어 분할(word segmentation)으로 분리 해야한다.

- 정규표현식을 이용한 토큰화
    - 정규표현식은 regex 혹은 regexp라고 표현.

    - 문자열에 대해 원하는 검색 패턴을 지정하는 방법

    - 이 패턴은 보통 문자열을 검색하고 치환하는 데 사용됨.

    - 정규표현식에서는 메타 문자로 패턴을 표현

    - NLTK에서는 정규표현식을 사용하는 토크나이저를 RegexpTokenizer로 제공.

- 노이즈와 불용어 제거
    - 정규표현식을 이용한 토큰화 과정에서는 특수문자와 같은 불필요한 문자를 혹은 노이즈가 제거되는 것을 볼 수 있음.

    - 길이가 짧은 단어들은 정규표현식을 써서 쉽게 제거할 수 있다.  
    -> 영어에서는 보통 길이가 3 미만인 단어들을 삭제하는 것이 일반적.

    - NLTK에서 stopwords라는 라이브러리를 이용해 언어별 불용어 사전을 제공.

    - 자신만의 불용어 사전 생성 가능.

---
#### 2.3 정규화

- 정규화는 같은 의미를 가진 동일한 단어이면서 다른 형태로 쓰여진 단어들을 통일해 표준 단어로 만드는 작업  
-> ex) go가 he, she 같은 3인칭 단수와 쓰일 떄는 goes가 되는데, 필요에 따라 go와 goes를 같은 단어로 취급해야 할 때가 있음.

- 정규화는 방법에 따라 어간 추출과 표제어 추출로 나뉜다.

- 어간 추출
    - 어형이 변형된 단어로부터 접사 등을 제거하고 그 단어의 어간을 분리해 내는 작업.
        ```
        1) 어형 : 단어의 형태를 의미
        2) 어간(stem) : 어형변화에서 변화하지 않는 부분
                        용언의 바뀌지 않는 부분, 어미는 바뀌는 부분.
        3) 용언 : 문장 안에서 서술하는 구실을 하는 동사와 형용사.
        ```
    - 영어에 대한 어간 추출 알고리즘으로는 포터 스테머(Poter Stemmer), 랭카스터 스테머(Lancaster Stemmer)등이 알려져 있음.
        ```
        1) 포터 스테머 : 영어분야에서는 사실상의 표준(de factostandard)
        2) 랭카스터 스테머 : 포터스테머와는 다른 알고리즘을 사용하여 결과도 조금씩 다름.
        ```

- 표제어 추출(Lemmatization)

    - 표제어 추출은 주어진 단어를 기본형으로 변환하는 것을 의미

    - 영어에 대한 표제어 추출기(lemmatizer)로 유명한 어휘 데이터베이스인 WordNet을 이용한 WordNetlemmatizer가 잘 알려져 있다.

    - 스테머와 다르게 WordNetlemmatizer는 품사를 따로 지정하지 않으면 기본형 그대로 반환한다.

---
#### 2.4 품사 태깅

- 토큰화, 정규화 과정을 거쳐서 나온 결과를 보통 형태소 라고 한다.

- 형태소 : 의미를 가진 가장 작은 말의 단위

- 품사의 이해

    |품사|설명|
    |---|---|
    |명사|이름을 나타내는 낱말|
    |대명사|이름을 대신해 가리키는 낱말|
    |수사|수량이나 순서를 가리키는 낱말|
    |조사|도와주는 낱말|
    |동사|움직임을 나타내는 낱말|
    |형용사|상태나 성질을 나타내는 낱말|
    |관형사|체언을 꾸며 주는 낱말|
    |부사|주로 용언을 꾸며 주는 낱말|
    |감탄사|놀람, 느낌, 부름, 대답을 나타내는 낱말|

    - 품사 태깅(Part-of-Speech Tagging)은 형태소에 대해 품사를 파악해 부착(tagging)하는 작업을 말한다.

    - 공용 품사 태그 집합
        - 각 언어의 특징에 따라 품사도 달라진다.

        - 영어의 전치사는 한글에는 없으며, particle(일종의 전치사)에 해당하며 우리망의 품사는 없다.

        - 공용 품사 태그 집합(Universal Part-of-Speech-Taget)도 연구하는 주체에 따라 다르게 정의되므로 표준은 없다.

        |태그|뜻|예|
        |---|---|---|
        |ADJ|adjective|new, good, high, special, big, local|
        |ADP|adposition|on, of, at, with, by, into, under|
        |ADV|adverb|really, already, still, early, now|
        |CONJ|conjunction|and, or, but, if, while, although|
        |DET|determiner, article|the, a, some, most, every, no, which|
        |NOUN|noun|year, home, costs, time, Africa|
        |NUM|numeral|twenty-four, fourth, 1991, 14:24|
        |PRT|particle|at, on, out, over per, that, up, with|
        |PRON|pronoun|he, their, her, its, my, I, us|
        |VERB|verb|is, say, told, given, playing, would|
        |.|punctuation marks|.,;!|
        |X|other|ersatz, esprit, dunno, gr8, univeristy|

    - 펜 트리뱅크 태그 집합

        - 공용 품사 태그 집합에 비해 훨씬 세분화된 품사 분류를 사용.

        - 36개로 구성된 펜 트리뱅크 태그가 있음.

- NLTK를 활용한 품사 태깅
    - 영어로 된 텍스트에 대해 품사 태깅을 한다고 하면 NLTK를 사용하는 것이 가장 편함.

    - nltk.pos_tag()은 토큰화된 결과에 대해 품사를 태깅해(단어, 품사)로 구성된 튜플의 리스트로 품사 태깅 결과를 반환한다.

    - 원하는 품사의 단어들만 추출
        ```Python
        my_tag_set = ['NN', 'VB', 'JJ']
        my_words = [word for word, tag in nltk.pos_tag(tokens) if tag in my_tag_set]
        print(my_words)
        ```

    - 단어에 품사 정보를 추가해 구분
        - 동음이의어를 처리하거나 품사를 이용해 단어를 더 정확하게 구분하고 싶다면, 단어 뒤에 품사 태그를 붙여 사용 가능.

- 한글 형태소 분석과 품사 태깅
    - 형태소 분석
    
    - 품사 태깅
        - 영어는 명사, 대명사, 형용사, 동사, 부사, 전치사, 접속사, 감탄사의 8품사로 구성
        - 한글은 전치사와 접속사가 없고, 수사, 조사, 관형사가 들어간 9품사로 구성
    
    - 파이썬에서 쓸 수 있는 대표적인 형태소 분석 및 품사 태깅 라이브러리는 KoNLPy(코엔엘파이)